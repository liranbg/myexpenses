language: node_js
node_js: lts/*
sudo: false

before_install:
- curl -o- -L https://yarnpkg.com/install.sh | bash -s -- --version 1.4.0
- export PATH=$HOME/.yarn/bin:$PATH

cache:
  directories:
    - node_modules
    - functions/tag-uses/node_modules
  yarn: true

install:
- yarn install
- yarn build

branches:
  only:
    - "master"

before_deploy:
  - yarn install --cwd functions/tag-uses

deploy:
  skip_cleanup: true
  provider: firebase
  token: $FIREBASE_TOKEN
